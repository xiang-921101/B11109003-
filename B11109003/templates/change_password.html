<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>更改密碼</title>
<style>
    @font-face {
        font-family: "MyGameFont";
        src: url("{{ url_for('static', filename='fonts/myfont.ttf') }}");
    }
    
    /* 統一 body 樣式：移除大間隔，讓 navbar 靠邊 */
    body { 
        font-family: "MyGameFont", "Microsoft JhengHei"; 
        background: #FFF7D6; 
        margin: 0; /* 新增 */
        padding: 0; /* 新增 */
        color: #6b4f3a; 
    }
    
    /* 導覽列 */
    .navbar {
        display: flex;
        justify-content: flex-end;
        background-color: #d4a373;
        padding: 15px 30px; /* 右側間隔 30px */
        width: 100%;
        box-sizing: border-box; /* 確保 padding 不會造成水平捲動條 */
    }
    .navbar a { 
        color: #fff; 
        text-decoration: none; 
        margin-left: 30px; /* 項目之間間隔 30px (原 20px) */
        font-size: 24px; /* 字體大小 (原 20px) */
        transition: 0.3s;
    }
    .navbar a:hover { /* 新增 hover 效果 */
        text-shadow: 0 0 5px rgba(0,0,0,0.3);
    }
    
    /* 頁面內容樣式 (保持不變) */
    form { max-width:400px; margin:40px auto; background:#fff8e5; padding:20px; border-radius:12px; box-shadow:0 0 10px rgba(0,0,0,0.1);}
    input { width:calc(100% - 24px); padding:10px; margin:10px 0; border-radius:8px; border:2px solid #d4a373;}
    button { width:100%; padding:10px; border-radius:8px; border:2px solid #d4a373; background:#d4a373; color:#fff; cursor:pointer; }
    button:hover { background:#b7793f; border-color:#b7793f; }
    .msg { color: red; text-align:center; margin-bottom:10px; }
</style>
</head>
<body>

    <nav class="navbar">
        <a href="/home">每日小任務</a>
        <a href="/profile">個人資料</a>
        <a href="/diary">福寶日誌</a>
    </nav>

<h2 style="text-align:center;">更改密碼</h2>

{% if message %}
    <div class="msg">{{ message }}</div>
{% endif %}

<form method="POST">
    <label>舊密碼：</label>
    <input type="password" name="old1" required>
    <label>再輸入一次舊密碼：</label>
    <input type="password" name="old2" required>
    <label>新密碼：</label>
    <input type="password" name="new1" required>
    <label>再輸入一次新密碼：</label>
    <input type="password" name="new2" required>
    <button type="submit">確認更改</button>
</form>

<script>
    const form = document.querySelector('form');
    
    form.addEventListener('submit', function(e) {
        e.preventDefault(); // 阻止表單預設提交

        // 收集表單數據
        const formData = new URLSearchParams();
        for (const [key, value] of new FormData(form).entries()) {
            formData.append(key, value);
        }

        fetch('/change_password', {
            method: 'POST',
            body: formData
        })
        .then(res => res.text()) // 取得純文字回應
        .then(text => {
            if (text.includes("密碼更改成功")) {
                alert(text);
                // 成功後跳轉到個人資料頁
                window.location.href = "/profile"; 
            } else {
                // 錯誤訊息，彈出提示框
                alert(text);
            }
        })
        .catch(error => {
            alert('發生錯誤，請稍後再試。');
        });
    });
</script>

</body>
</html>